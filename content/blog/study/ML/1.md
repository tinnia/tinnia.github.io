---
title: "Numpy"
date: "2021-01-23T01:41:32.169Z"
path: "/Study/ml/1/"
category: "Study"
ci: "ML"
cat: "ML"
tags: ["ML", "Python", "Numpy"]
description: "ML - Numpy"
---



### Numpy

##### 특징

* Python의 고성능 과학 계산용 패키지
* 일반 List에 비해 빠름
* 메모리 효율적
* 반복문 없이 데이터 배열 처리 가능

<br />

##### 설치

* Conda

  ```sh
  conda install numpy
  ```

* pip

  ```sh
  pip install numpy
  ```

<br />

##### 사용

```python
import numpy as np
# 보통 np라는 별칭으로 호출
```

<br />

##### 사용해본 코드

###### Array

* Type

  ```python
  arr = np.array([1, 2, 3, 4], float)
  arr
  # array([1., 2., 3., 4.])
  
  type(arr[2])
  # numpy.float64
  
  arr.dtype	# 배열의 전체 데이터 Type
  # dtype('float64')
  ```

* Shape

  ```python
  matrix = [[1,2], [3,4], [5,6], [7,8]]
  np.array(matrix, int).shape
  # (4, 2)
  ```

* Size

  ```python
  matrix = [[1,2], [3,4], [5,6], [7,8]]
  np.array(matrix, int).size
  # 8
  ```

* dtype - dtype을 int로 선언하면 다른 형태의 data도 int형태가 된다.

  ```python
  np.array([[1, 2, 3], [4, 5, 6.5]], dtype=int)
  # array([[1, 2, 3], [4, 5, 6]])
  ```

* reshape - array 크기 변경 (개수는 동일)

  ```python
  matrix = [[1, 2, 3, 4], [5, 6, 7, 8]]
  np.array(matrix).shape
  # (2, 4)
  
  np.array(matrix).reshape(8, )
  # array([1, 2, 3, 4, 5, 6, 7, 8])
  ```

* flatten - 다차원 array 1차원으로 변환

  ```python
  matrix = [[1, 2, 3, 4], [5, 6, 7, 8]]
  np.array(matrix).flatten()
  # array([1, 2, 3, 4, 5, 6, 7, 8])
  ```

* Indexing

  * 1차원

    ```python
    arr = np.arange([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
    arr[5]
    # 5
    
    arr[1:5]
    # array([1, 2, 3, 4])
    
    arr[:]
    # array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
    ```

  * 다차원

    ```python
    # arr[행 : 열] - 다차원에서는 :를 기준으로 분리
    arr = np.array([[0, 1, 2], [3, 4, 5], [6, 7, 8]])
    arr[2, :]
    # array([6,7,8])
    
    arr[0:2,]
    # array([[0, 1, 2], [3, 4, 5]])
    
    arr[:,2]
    # array([2, 5, 8])
    
    arr[:,:2]
    # array([[0, 1], [3, 4], [6, 7]])
    ```

* Slicing

  ```python
  arr = np.array([[0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14]])
  arr[:, ::2]
  # array([[0, 2, 4], [5, 7, 9], [10, 12, 14]])
  
  arr[::2, ::3]
  # array([[0, 3], [10, 13]])
  ```

* Arange

  ```python
  np.arange(10)
  # array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
  
  np.arange(0, 3, 0.5)
  # array([0, 0.5, 1, 1.5, 2, 2.5])
  ```

* Zeros, Ones, Empty

  ```python
  np.zeros((2, 3))
  # array([[0., 0., 0.], [0., 0., 0.]])
  
  np.ones(shape=(5,), dtype=np.int8)
  # array([1, 1, 1, 1, 1], dtype=int8)
  
  np.empty(shape=(10, ), dtype=np.int8)
  # array([0, 0, 0, 0, 0, 0, 0, 64, -74, 105], dtype=int8)
  ```

* diag -  대각선 행렬 값 추출

  ```python
  matrix = np.arange(9).reshape(3, 3)
  np.diag(matrix)
  # array([0, 4, 8])
  
  np.diag(matrix, k=1)	# k = start_index
  # array([1, 5])
  ```

* Sum

  ```python
  arr = np.arange(1, 11)
  arr.sum(dtype=np.float)
  # 55.0
  ```

* axis

  ```python
  # (3, 4) -> axios=0 : 3, axios=1 : 4
  
  matrix = np.arange(9).reshape(3, 3)
  matrix.sum(axis=0)
  # array([9, 12, 15])
  ```

* mean

  ```python
  arr = np.arange(1, 13).reshape(3, 4)
  arr.mean()
  # 6.5
  ```

* concatenate

  ```python
  a = np.array([1, 2, 3])
  b = np.array([4, 5, 6])
  np.vstack((a, b)) = np.concatenate((a,b), axis=0)
  # array([[1, 2, 3], [4, 5, 6]])
  
  a = np.array([1, 2], [4, 5])
  b = np.array([3, 6])
  np.hstack((a, b)) = np.concatenate((a,b.T), axis=1)
  # array([[1, 2, 3], [4, 5, 6]])
  ```

* transpose

  ```python
  arr = np.arange(1, 7).reshape(2, 3)
  # array([[1, 2, 3], [4, 5, 6]])
  
  arr.transport() = arr.T
  # array([[1, 4], [2, 5], [3, 6]])
  ```

* scalar

  ```python
  arr = np.arange(1, 7).reshape(2, 3)
  arr + 3
  # array([[4, 5, 6], [7, 8, 9]])
  ```

* any, all

  ```python
  arr = np.arange(10)
  np.any(arr>5), np.any(arr<0)	# any : 하나라도 만족하면 true
  # (True, False)
  
  np.all(arr>5), np.all(arr<10)	# all : 모두 만족하면 true
  # (False, True)
  ```

* argmax, argmin - array 내 최대, 최소 index 반환

  ```python
  arr = np.arange(10)
  np.argmax(arr), np.argmin(arr)
  # (10, 0)
  ```

  