---
title: "PYTHON - 에라토스테네스의 체"
date: "2021-02-24T17:19:32.169Z"
path: "/Algorithm/reference/4/"
category: "Algorithm"
ci: "REF"
cat: "REFERENCE"
tags: ["REFERENCE", "Sieve of Eratosthenes"]
description: "[Sieve of Eratosthenes] 소수 체크와 소인수 분해"
---

<small>관련 문제</small>

<hr />

<br />

### 에라토스테네스의 체

<br />

##### 소수 체크

###### 기본

```python
def prime_check(N):
    for i in range(2, N):
        if N % i == 0:
            return False
        if i * i > N:
            break
    return True
```



###### 에라토스테네스의 체

```python
def era_prime(N):
    A, p = [0 for _ in range(N + 1)], []
    for i in range(2, N):
        if A[i] == 0:
            p.append(i)
        for j in range(i ** 2, N, i):
            A[j] = 1
    return p
```

<br />

##### 소인수 분해

###### 기본

```python
def prime_factorization(N):
    p, fac = 2, []
    while p ** 2 <= N:
        if N % p == 0:
            N //= p
            fac.append(p)
        else:
            p += 1
    if N > 1:
        fac.append(N)
    return fac
```

###### 에라토스테네스의 체 활용

```python
# 이미 소수 리스트를 구한 경우 
def prime_factorization2(N, p):
    fac = []
    for i in p:
        if N == 1 or N > i * i:
            break
        while N % i:
            fac.append(i)
            N //= i
    return fac
```



<br />

##### 에라토스테네스의 체 활용 문제

###### 1. 소인수의 개수

```python
def era_factor_cnt(N):
    A = [0 for _ in range(N + 1)]
    for i in range(2, N):
        for j in range(i, N, i):
            A[j] += 1
    return A
```



###### 2. 소인수의 합

```python
def era_factor_sum(N):
    A = [0 for _ in range(N + 1)]
    for i in range(2, N):
        for j in range(i, N, i):
            A[j] += i
    return A
```



###### 3. 소인수 분해 하기

```python
def era_factorization(N):
    A = [0 for _ in range(N + 1)]
    for i in range(2, N):
        if A[i]:
            continue
        for j in range(i, N, i):
            A[j] = i
    return A

A = era_factorization(100)
N = 84
while A[N] != 0:
    print(A[N])
    N //= A[N]
# 7 3 2 2
```





